skip: False
name: runAMPL
description: "\n\nTest cases for runAMPL tool"
cwd: ../../dist/bin/
binary_path: ../../dist/bin/runAMPL
#show_results_diff: True

text_output: &TEXT_OUTPUT
  treat_as: text
bytes_output: &BYTES_OUTPUT
  treat_as: bytes
json_output: &JSON_OUTPUT
  treat_as: json


ALL_POSSIBLE_FLAGS:
#  - name: ampl
#    value: <filename>
#  - name: xml-input <xml filename>
#  - name: xml-output <xml filename>
#  - name: json-file <filename>
#  - name: json-output <filename>
#  - name: document-conf <filename> (short -dc)
#  - name: mode redlining/publish
#  - name: redlining
#  - name: output-new-xml
#  - name: db <path>
#  - name: base-db <path>
#  - name: branch <branch-name>
#  - name: orig-branch <branch-name>
#  - name: lawdate <mm/dd/yyyy>
#  - name: amend-date <mm/dd/yyyy>
#  - name: alias <orig> <new>
#  - name: retrieve-xmls


default_parameters: &DEFAULT_TEST_PARAMETERS
  skip: True
  cwd: ../../dist/bin/

  stdin:  &STDIN
    <<: *BYTES_OUTPUT
    directory: &STDIN_DIR ../AMPL-test2
    treat_as: bytes
  stdout: &STDOUT
    <<: *JSON_OUTPUT
    directory: &RESULT_DIR tests_data/runAMPL/stdout/
  stderr: &STDERR
    <<: *TEXT_OUTPUT
    directory: &ERR_DIR tests_data/runAMPL/stderr/
  expected_stdout: &EXPECTED_STDOUT
    <<: *JSON_OUTPUT
    directory: &EXPECTED_RESULTS_DIR tests_data/runAMPL/
  expected_return_code: 0

tests:
  - <<: *DEFAULT_TEST_PARAMETERS
    skip: False
    test: "* with default flags"
    flags:
      - name: db
        value: resultsdb
      - name: base-db
        value: xmldb
      - name: branch
        value: ampl_115hr5554enr
      - name: alias
        value: "/us/named/internal_revenue_code_of_1986 /us/usc/t26"
#    arguments:
#      - -alias /us/named/internal_revenue_code_of_1986
    stdin:
      <<: *STDIN
      file_path: [*STDIN_DIR, ampl-115hr5554enr.json]
    stdout:
      <<: *STDOUT
      file_path: [*RESULT_DIR, ampl-115hr5554enr.json]
    stderr:
      <<: *STDERR
      file_path: [*ERR_DIR, ampl-115hr5554enr.error.log]
    expected_stdout:
#    expected_stdout:
#      <<: *EXPECTED_STDOUT
#      content: |
#        {"a": Some text}
#      file_path: [*EXPECTED_RESULTS_DIR, 116hr1500ih.json]
